---
title: "Analysing Cat Hunting Behaviour"
subtitle: "INFO 526 - Fall 2023 - Project 1"
author: "Team R-tisans of Visual : Visalakshi Prakash Iyer,
         Rahul Bangad, 
         Kashyap Sai Prasad Nadendla,
         Athira Thekkemadathil Anilkumar"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidyverse,
               ggplot2,
               here,
               ggridges,
               ggtext,
               ggrepel
               )
cats_new <- read.csv(here("cats_all_new.csv"))
```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here
data(mtcars)
mtcars$speed <- mtcars$hp / mtcars$wt

data("penguins")
```

# Understanding the Hunt: Cat Predatory Behavior {.slide-understanding-hunt style=".slide-understanding-hunt {     background: linear-gradient(to bottom right, #E0E0E0, #A9A9A9); /* Gradient from light grey to dark grey */     color: #FFFFFF; /* White text color */     display: flex;     align-items: center; /* Center the content vertically */     justify-content: center; /* Center the content horizontally */ }.slide-understanding-hunt h1 {     font-family: 'Georgia', serif; /* Stylish font */     font-size: 2.5em; /* Font size */     text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); /* Text shadow for depth */     margin: 0; /* Remove default margins */ }"}

## Dataset Description

::: incremental
-   Dataset is drawn from TidyTuesday

-   The **Pet Cats** data set comes from [**Movebank for Animal Tracking Data**](https://www.datarepository.movebank.org/handle/10255/move.882), collected from volunteers using GPS sensors on their pet cats around *UK, US, Australia and New Zealand*.

-   The dataset from US,UK,Australia,New Zealand have been merged to form a new data set which is used for plotting is

    ::: {.column width="40%"}
    :::
:::

## Q1. Are the cats which live together better at hunting than those which live alone?

::: columns
::: {.column width="50%"}
**Plot 1**

-   jitter plot with pray caught per month by the number of cats living together

-   cats have been categorized based on their age group
:::

::: {.column width="50%"}
**Plot 2**

-   Line plot with pray caught per month by the number of cats living together
-   cats have been categorized based on their sex
:::
:::

## Code

```{r, echo=TRUE, warning=FALSE , message=FALSE}
cat_annot <- cats_new |>
  filter(n_cats > 0) |>
  mutate(
    age_grp = case_when(
      age_years >= 0 & age_years <= 5 ~ "Kitten",
      age_years > 5 & age_years <= 10 ~ "Young",
      TRUE ~ "Mature"
    )
  ) |>
  group_by(age_grp, n_cats) |>
  filter(n_cats < 2 | n_cats > 6) |>
  summarise(prey_p_month = max(prey_p_month),
            .groups = "keep")

cats_new |>
  filter(n_cats > 0) |>
  mutate(
    age_grp = case_when(
      age_years >= 0 & age_years <= 5 ~ "Kitten",
      age_years > 5 & age_years <= 10 ~ "Young",
      TRUE ~ "Mature"
    ),
    hrs_bin = ifelse(hrs_indoors <= 10, 10, 20)
  ) |>
  ggplot(aes(x = reorder(n_cats, str_sort(n_cats)), 
             y = prey_p_month)) +
  geom_jitter(data = cats_new, color = "snow3") + 
  geom_jitter(aes(fill = age_grp), size=2.2, pch=21) +
  facet_wrap(~ fct_relevel(age_grp, c("Kitten", "Young", "Mature"))) +
  scale_fill_manual(values=c("steelblue3","maroon4","salmon2")) +
  labs(
    title = "How good are loner cats at hunting?",
    subtitle = "as opposed to the cats that live in group \nGrouped w.r.t age",
    caption = "Q 1 | Plot 1",
    x = "Number of cats",
    y = "Prey caught per month"
  ) +
  geom_text_repel(data = cat_annot, aes(label = prey_p_month), 
                  nudge_x = 0.3, nudge_y = 0.2, size = 5) +
  # geom_text_repel(aes(group = age_grp, label = "label")) +
  theme_minimal()

```

## Plot

```{r, echo=FALSE, warning=FALSE , message=FALSE}
cat_annot <- cats_new |>
  filter(n_cats > 0) |>
  mutate(
    age_grp = case_when(
      age_years >= 0 & age_years <= 5 ~ "Kitten",
      age_years > 5 & age_years <= 10 ~ "Young",
      TRUE ~ "Mature"
    )
  ) |>
  group_by(age_grp, n_cats) |>
  filter(n_cats < 2 | n_cats > 6) |>
  summarise(prey_p_month = max(prey_p_month),
            .groups = "keep")

cats_new |>
  filter(n_cats > 0) |>
  mutate(
    age_grp = case_when(
      age_years >= 0 & age_years <= 5 ~ "Kitten",
      age_years > 5 & age_years <= 10 ~ "Young",
      TRUE ~ "Mature"
    ),
    hrs_bin = ifelse(hrs_indoors <= 10, 10, 20)
  ) |>
  ggplot(aes(x = reorder(n_cats, str_sort(n_cats)), 
             y = prey_p_month)) +
  geom_jitter(data = cats_new, color = "snow3") + 
  geom_jitter(aes(fill = age_grp), size=2.2, pch=21) +
  facet_wrap(~ fct_relevel(age_grp, c("Kitten", "Young", "Mature"))) +
  scale_fill_manual(values=c("steelblue3","maroon4","salmon2")) +
  labs(
    title = "How good are loner cats at hunting?",
    subtitle = "as opposed to the cats that live in group \nGrouped w.r.t age",
    caption = "Q 1 | Plot 1",
    x = "Number of cats",
    y = "Prey caught per month"
  ) +
  geom_text_repel(data = cat_annot, aes(label = prey_p_month), 
                  nudge_x = 0.3, nudge_y = 0.2, size = 5) +
  # geom_text_repel(aes(group = age_grp, label = "label")) +
  theme_minimal()

```

## Text

-   Kittens excel in hunting , especially when living alone or in pairs, capturing between 10 and 20 prey monthly.

-   Hunting efficiency declines as group size exceeds two, particularly among young cats which often capture less than 10 prey monthly.

-   Mature cats show varied hunting success rates, with a broad spread in the data.

# Plot 2...

## Code

```{r, echo=TRUE, warning=FALSE , message=FALSE}
cats_new |>
  filter(n_cats > 0) |>
  group_by(animal_sex, n_cats) |>
  summarise(avg_prey = median(prey_p_month), 
            min_prey = min(prey_p_month),
            max_prey = max(prey_p_month),
            .groups = "keep") |>
  mutate (
    n_cats = ifelse(animal_sex == "f", n_cats + 0.2, n_cats - 0.2),
    avg_prey = ifelse(animal_sex == "f", avg_prey + 0.2, avg_prey - 0.2)
    ) |>
  ggplot(aes(color=animal_sex)) +
  geom_segment(aes(x = min_prey,
                   y = n_cats,
                   xend = max_prey,
                   yend = n_cats
                   ),
               linewidth = 0.8,
               position = position_jitterdodge(dodge.width = -0.2)
               ) +
  geom_point(aes(x = avg_prey, y = n_cats),
             size = 3,
             ) +
  scale_color_manual(values = c("steelblue3", "maroon4")) + 
  labs(
    title = "How good are loner cats at hunting",
    subtitle = "as opposed to the cats that live in group \n
                Grouped w.r.t the sex of the cat",
    x = "Prey caught per month",
    y = "Number of cats",
    color = "Animal Sex"
  ) +
  scale_y_continuous(breaks = c(seq(0,8,1), c(11))) +
  geom_text(aes(x = 10, y= 8, label = "Has a cat door")) +
  theme_minimal()
```

## Plot

```{r, echo=FALSE, warning=FALSE , message=FALSE}
cats_new |>
  filter(n_cats > 0) |>
  group_by(animal_sex, n_cats) |>
  summarise(avg_prey = median(prey_p_month), 
            min_prey = min(prey_p_month),
            max_prey = max(prey_p_month),
            .groups = "keep") |>
  mutate (
    n_cats = ifelse(animal_sex == "f", n_cats + 0.2, n_cats - 0.2),
    avg_prey = ifelse(animal_sex == "f", avg_prey + 0.2, avg_prey - 0.2)
    ) |>
  ggplot(aes(color=animal_sex)) +
  geom_segment(aes(x = min_prey,
                   y = n_cats,
                   xend = max_prey,
                   yend = n_cats
                   ),
               linewidth = 0.8,
               position = position_jitterdodge(dodge.width = -0.2)
               ) +
  geom_point(aes(x = avg_prey, y = n_cats),
             size = 3,
             ) +
  scale_color_manual(values = c("steelblue3", "maroon4")) + 
  labs(
    title = "How good are loner cats at hunting",
    subtitle = "as opposed to the cats that live in group \n
                Grouped w.r.t the sex of the cat",
    x = "Prey caught per month",
    y = "Number of cats",
    color = "Animal Sex"
  ) +
  scale_y_continuous(breaks = c(seq(0,8,1), c(11))) +
  geom_text(aes(x = 10, y= 8, label = "Has a cat door")) +
  theme_minimal()
```

## Text

## Q2. How does the reproductive status of cats influence the hunting pattern?

::: columns
::: {.column width="50%"}
**Plot 1**

-   A density ridge plot with animal reproductive condition with prey caught per month

-   Categorized by country
:::

::: {.column width="50%"}
**Plot 2**

-   Age of the cat with prey caught per month

-   Categorized by animal reproduction condition
:::
:::

## Code

```{r, echo=TRUE, warning=FALSE , message=FALSE}
cats_new |>
  #stat(quantile) calculates the values for the data distribution
  #Three quantiles - 25th, 50th and 75th
  #factor function converts the quantile value to a category to attach a color to it
  ggplot(aes(x=prey_p_month,y=animal_reproductive_condition, 
             fill = factor(stat(quantile)))) +
  #quantiles 3 selected
  #alpha of 0.5 to show transperancy
  #bandwidth specifies the width of the kernel
  #smaller bandwidth captures finer details, variations but also noise
  #larger bandiwdth results in wider kernerl and more generalized view
  stat_density_ridges(quantile_lines = TRUE, 
                      quantiles = 3, 
                      alpha = 0.5,
                      geom = "density_ridges_gradient", 
                      bandwidth = 1.5) +
    scale_fill_manual(values = c("pink2","skyblue","maroon4"), 
                      name = "Quantile") +
  scale_x_continuous(breaks = seq(0,23,5))+
  #seperate density_ridge by country
  facet_wrap(~cats_new$study_site) +
  labs(
    title = "How are cats impacted by their reproductive condition?",
    subtitle = "Categorized by different countries",
    x = "Prey per month",
    y = "Annimal reproductive condition"
  ) +
  theme_minimal()
```

## Plot

```{r, echo=FALSE, warning=FALSE , message=FALSE}
cats_new |>
  #stat(quantile) calculates the values for the data distribution
  #Three quantiles - 25th, 50th and 75th
  #factor function converts the quantile value to a category to attach a color to it
  ggplot(aes(x=prey_p_month,y=animal_reproductive_condition, 
             fill = factor(stat(quantile)))) +
  #quantiles 3 selected
  #alpha of 0.5 to show transperancy
  #bandwidth specifies the width of the kernel
  #smaller bandwidth captures finer details, variations but also noise
  #larger bandiwdth results in wider kernerl and more generalized view
  stat_density_ridges(quantile_lines = TRUE, 
                      quantiles = 3, 
                      alpha = 0.5,
                      geom = "density_ridges_gradient", 
                      bandwidth = 1.5) +
    scale_fill_manual(values = c("pink2","skyblue","maroon4"), 
                      name = "Quantile") +
  scale_x_continuous(breaks = seq(0,23,5))+
  #seperate density_ridge by country
  facet_wrap(~cats_new$study_site) +
  labs(
    title = "How are cats impacted by their reproductive condition?",
    subtitle = "Categorized by different countries",
    x = "Prey per month",
    y = "Annimal reproductive condition"
  ) +
  theme_minimal()

```

## Text

The graph shows how cats' hunting abilities vary by country and neuter status. Cats who haven't been neutered tend to be better hunters in both Australia and the United Kingdom. Notably, in the US and New Zealand, data for unneutered cats is absent, Among the displayed data, neutered cats in the US tend to catch slightly more prey, indicating that the effects of neutering on hunting abilities can vary by region.

# Plot 2...

## Code

```{r, echo=TRUE, warning=FALSE , message=FALSE}
cats_new |>
  ggplot(aes(x = prey_p_month, y = age_years, color=animal_reproductive_condition)) + 
  geom_hex(bins=15, show.legend = FALSE) +
  geom_hex(data = cats_new |> 
             filter(animal_reproductive_condition == "Unneutered"), 
           bins = 15, 
           fill = "maroon4", 
           color = "maroon4",
           show.legend = TRUE) +
  scale_color_manual(values=c("white", "black")) +
  # scale_fill_manual(values = "pink2", "maroon4") +
  scale_x_continuous(breaks = seq(0,22,2)) + 
  scale_fill_gradient(low = "pink2", high = "salmon2") +
  labs(
    title = "How are cats impacted by their reproductive condition?",
    subtitle =  "Observed w.r.t the age of the cat",
    x = "Prey caught per month",
    y = "Age of the cat"
  ) +
  theme_minimal() +
  theme(
    panel.grid.minor = element_line(linetype = "dashed", color = "grey"),
    panel.grid.major = element_blank(),
    legend.position = "top", legend.justification = "right"
  ) + 
  guides(
    color = guide_legend(override.aes = list(fill = c("pink2", "maroon4"),
                                             color = c("white", "black")))
  )
```

## Plot

```{r, echo=FALSE, warning=FALSE , message=FALSE}
cats_new |>
  ggplot(aes(x = prey_p_month, y = age_years, color=animal_reproductive_condition)) + 
  geom_hex(bins=15, show.legend = FALSE) +
  geom_hex(data = cats_new |> 
             filter(animal_reproductive_condition == "Unneutered"), 
           bins = 15, 
           fill = "maroon4", 
           color = "maroon4",
           show.legend = TRUE) +
  scale_color_manual(values=c("white", "black")) +
  # scale_fill_manual(values = "pink2", "maroon4") +
  scale_x_continuous(breaks = seq(0,22,2)) + 
  scale_fill_gradient(low = "pink2", high = "salmon2") +
  labs(
    title = "How are cats impacted by their reproductive condition?",
    subtitle =  "Observed w.r.t the age of the cat",
    x = "Prey caught per month",
    y = "Age of the cat"
  ) +
  theme_minimal() +
  theme(
    panel.grid.minor = element_line(linetype = "dashed", color = "grey"),
    panel.grid.major = element_blank(),
    legend.position = "top", legend.justification = "right"
  ) + 
  guides(
    color = guide_legend(override.aes = list(fill = c("pink2", "maroon4"),
                                             color = c("white", "black")))
  )
```

## Text

-   As cats age, they generally catch less prey, regardless of being Fixed or Unneutered.

-   Unneutered cats aged 10-14 years are the most proficient hunters.

-   Older unneutered cats catch fewer prey compared to their younger selves.

-   Data is limited on unneutered cats over 15 years old, suggesting they might hunt less or are underrepresented in the study.

## Images

![Image credit: Danielle Navarro, Percolate.](images/watercolour_sys02_img34_teacup-ocean.png){fig-align="center" width="500"}

## Math Expressions {.smaller}

You can write LaTeX math expressions inside a pair of dollar signs, e.g. \$\\alpha+\\beta\$ renders $\alpha + \beta$. You can use the display style with double dollar signs:

    $$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

$$
\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
$$

Limitations:

1.  The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

2.  There should not be spaces after the opening `$` or before the closing `$`.

# Wrap up

## Feeling adventurous?

-   You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

-   But some of you might want to play around with slide styling. Some solutions for this can be found at https://quarto.org/docs/presentations/revealjs.
